# System Patterns

## Architecture
- Static website generated by 11ty.
- Content is sourced from Markdown files organized within discipline-specific directories.
- Hosted directly via GitHub Pages.

## Content Organization
- **Top-level:** Disciplines (e.g., `development/`, `project-management/`, `sales-marketing/`, `content-strategy/`, `design/`)
- **Second-level:** Content Types (`prompts/`, `cursor-rules/`, `project-configs/`, `workflow-states/`)
- Specific content items are individual Markdown files within these directories, typically using `kebab-case.md` naming.
- An `index.njk` file often exists within discipline directories (e.g., `development/index.njk`) and content-type directories (e.g., `development/prompts/index.njk`) likely serving as landing/listing pages.
- 11ty collections are automatically generated for each content type, aggregating across disciplines.

## Templating
- Nunjucks (.njk) is used as the primary templating engine (for md, html, data files).
- Key layout files:
    - `_layouts/base.njk`
    - `_layouts/discipline.njk`
    - `_layouts/content-type.njk`
- Includes/partials are stored in `_includes/`.
- Global data is stored in `_data/`.
- Custom Nunjucks filters defined in `.eleventy.js`: `date`, `filterByDiscipline`, `fullUrl`, `hasContent`.
- Directory structure configured in `.eleventy.js`: input (`.`), output (`_site`), includes (`_includes`), layouts (`_layouts`), data (`_data`).

## Search
- A search index (`search-index.json`) is generated during build containing title, description, content, url, discipline, contentType, tags, and date for all `.md` files.
- Search functionality is implemented client-side via JavaScript in `_includes/search.njk`.
- **Implementation:**
    - Fetches `search-index.json` on page load.
    - Filters the index in the browser based on user input (case-insensitive matching on title, description, content, tags).
    - Results displayed dynamically, updating as user types (min 2 chars).
- **Features:**
    - Results link to the content page.
    - "View Prompt" button on each result opens a modal displaying the full Markdown content rendered using `marked.parse()` (requires `marked.js` library).
- Styling for search components and modal is included within `_includes/search.njk`.

## Styling & Assets
- Static assets (CSS, JS, Images) are located in the `assets/` directory and copied directly to `_site/assets` during build.

## CI/CD
- GitHub Actions workflow defined in `.github/workflows/deploy.yml`.
- **Trigger:** Runs on push to `main` branch and `workflow_dispatch`.
- **Environment:** `ubuntu-latest` with Node.js v22.
- **Process:**
    1. Checkout code.
    2. Setup Node.js & cache npm dependencies.
    3. Install dependencies (`npm install`).
    4. Build site (`npm run build`) - output to `./_site`.
    5. Deploy `./_site` contents to `gh-pages` branch using `peaceiris/actions-gh-pages@v4`.
- The build process adapts URLs based on `process.env.GITHUB_ACTIONS` (adds `/prompt_library` base path), configured in `.eleventy.js`.
- A `baseUrl` global variable and `pathPrefix` are configured in `.eleventy.js` to handle deployment to GitHub Pages subpath.

## Contribution Process
- Contribution guidelines are documented in the `contributing.njk` page.
- **Methods:**
    - **GitHub Direct:** Standard Fork -> Branch -> Add File -> Commit -> PR workflow.
    - **Cursor:** Recommends using Cursor AI with the `prompt-library-requirements` rule for guided content creation.
    - **GitHub Issues:** Allows users to suggest content via issues tagged "Content Suggestion:".
- **Content Requirements:**
    - **Metadata (Frontmatter):** `title`, `description`, `date`, `tags` (min 2).
    - **Formatting:** Markdown, clear headings, code blocks, reasonable line length, lists.
    - **Validation:** Check metadata, preview locally (`npm start`), validate links/code, check style.
- The `contributing.njk` page includes an accordion UI (JS/CSS) to present the methods.

### Planned Contribution Workflow (via Issue Templates)
- **Initiation:** Contributor selects an Issue Template (e.g., for prompts) and fills out the form.
- **Submission:** A GitHub Issue is created with structured data and specific labels (e.g., `new-contribution`, `needs-review`).
- **Curation:** Maintainer reviews the issue, verifies the content, and potentially refines the data (e.g., adds tags).
- **Conversion:** Maintainer manually creates the corresponding Markdown file in the correct location, populating the frontmatter and content from the issue data.
- **Integration:** Maintainer commits the new file, typically via a PR, for final review and merge.

## Section Initialization Pattern
- All discipline/content-type folders (e.g., `qa/prompts/`, `qa/cursor-rules/`, etc.) should be initialized with a customized `index.njk` file containing relevant metadata (title, description, layout, discipline, contentType, category) and placeholder content describing the section's purpose.
- This replaces the use of `.gitkeep` files for empty folder tracking, ensuring each section is ready for content and discoverable in the UI.
- This pattern was applied to the QA section, with each subfolder now containing a QA-specific `index.njk` file. 